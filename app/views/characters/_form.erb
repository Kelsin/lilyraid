<% div_for(character) do %>
  <% remote_form_for([character.account, character],
                     :loading => update_page do |page|
                         page["#{dom_id(character)}_submit"].value = "Saving"
                         page["#{dom_id(character)}_submit"].disable
                     end) do |f| %>
    <table class="info">
      <% if character.new_record? %>
        <tr>
          <th></th>
          <td><h2>New Character</h2>
        </tr>
      <% end %>
      <tr>
        <th>Name:</th>
        <td><%= f.text_field :name %></td>
      </tr>
      <tr>
        <th>Level:</th>
        <td><%= f.text_field :level, :size => 5 %></td>
      </tr>
      <tr>
        <th>Guild:</th>
        <td><%= f.text_field :guild  %></td>
      </tr>
      <% if character.new_record? %>
        <tr>
          <th>Race:</th>
          <td><%= f.collection_select(:race_id, Race.find(:all), :id, :name) %></td>
        </tr>
        <tr>
          <th>Class:</th>
          <td><%= f.collection_select(:cclass_id, Cclass.find(:all), :id, :name) %></td>
        </tr>
      <% else %>
        <tr>
          <th>Inactive:</th>
          <td>
            <%= f.check_box :inactive %>
            <p class="note">
              If you mark a character inactive they won't show up on the public
              member list, and won't be available when signing up for raids. You
              can mark them active again at any time.
            </p>
        <tr>
          <th>Keyed:</th>
          <td>
            <% Instance.keyed.each do |instance| %>
              <%= check_box_tag("character[instances][]",
                                instance.id,
                                character.keyed(instance)) %>
              <nobr><%= instance.name %></nobr><br />
            <% end %>
          </td>
        </tr>
      <% end %>
      <tr>
        <th></th>
        <td>
          <%= submit_tag "Save", :id => "#{dom_id(character)}_submit" %>
        </td>
      </tr>
    </table>
  <% end %>
<% end %>
